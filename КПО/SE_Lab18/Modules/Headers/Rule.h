#pragma once
#include "GRB.h"
#define GRB_ERROR_SERIES 600

namespace GRB {
#define NS(n) Rule::Chain::N(n)
#define TS(n) Rule::Chain::T(n)
    // ------------------------------------------
    // Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 1: ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð» ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¾ Ñ 6 Ð´Ð¾ 8
    // ------------------------------------------
    Greibach greibach(NS('S'), TS('$'), // ÑÑ‚Ð°Ñ€Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð», Ð´Ð½Ð¾ ÑÑ‚ÐµÐºÐ°
                      8, // ðŸ‘ˆ Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾: 6 -> 8
                      Rule(NS('S'), GRB_ERROR_SERIES + 0, // 600 - Ð½ÐµÐ²ÐµÑ€Ð½Ð°Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹
                           4, // S->m{NrE;}; | tfi(F){NrE;};S | m{NrE;};S | tfi(F){NrE;}
                           Rule::Chain(8, TS('m'), TS('{'), NS('N'), TS('r'), NS('E'), TS(';'), TS('}'),TS(';')),
                           Rule::Chain(14, TS('t'), TS('f'), TS('i'), TS('('), NS('F'), TS(')'), TS('{'), NS('N'),
                                       TS('r'), NS('E'), TS(';'), TS('}'), TS(';'), NS('S')),
                           Rule::Chain(9, TS('m'), TS('{'), NS('N'), TS('r'), NS('E'), TS(';'), TS('}'), TS(';'),
                                       NS('S')),
                           Rule::Chain(12, TS('t'), TS('f'), TS('i'), TS('('), NS('F'), TS(')'), TS('{'), NS('N'),
                                       TS('r'), NS('E'), TS(';'), TS('}'))
                      ),
                      Rule(NS('N'), GRB_ERROR_SERIES + 1, // 601 - ÐžÑˆÐ¸Ð±Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€
                           9, // N->dti;|rE;|i=E;|dtfi(F);|dtiN|rE;N|i=E;N|dtfi(F);N
                           Rule::Chain(4, TS('d'), TS('t'), TS('i'), TS(';')),
                           Rule::Chain(3, TS('r'), NS('E'), TS(';')),
                           Rule::Chain(4, TS('i'), TS('='), NS('E'), TS(';')),
                           Rule::Chain(4, TS('i'), TS('='), NS('E'), TS(';')), // Ð”ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚?
                           Rule::Chain(8, TS('d'), TS('t'), TS('f'), TS('i'), TS('('), NS('F'), TS(')'), TS(';')),
                           Rule::Chain(4, TS('d'), TS('t'), TS('i'), NS('N')),
                           Rule::Chain(4, TS('r'), NS('E'), TS(';'), NS('N')),
                           Rule::Chain(5, TS('i'), TS('='), NS('E'), TS(';'), NS('N')),
                           Rule::Chain(9, TS('d'), TS('t'), TS('f'), TS('i'), TS('('), NS('F'), TS(')'), TS(';'),
                                       NS('N'))
                      ),
                      Rule(NS('E'), GRB_ERROR_SERIES + 2, // 602 - ÐžÑˆÐ¸Ð±ÐºÐ° Ð² Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¸
                           8, // E->i|l|(E)|i(W)|iM|lM|(E)M|i(W)M
                           Rule::Chain(1, TS('i')),
                           Rule::Chain(1, TS('l')),
                           Rule::Chain(3, TS('('), NS('E'), TS(')')),
                           Rule::Chain(4, TS('i'), TS('('), NS('W'), TS(')')),
                           Rule::Chain(2, TS('i'), NS('M')),
                           Rule::Chain(2, TS('l'), NS('M')),
                           Rule::Chain(4, TS('('), NS('E'), TS(')'), NS('M')),
                           Rule::Chain(5, TS('i'), TS('('), NS('W'), TS(')'), NS('M'))
                      ),
                      // ------------------------------------------
                      // Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 2: Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ NS('F') Ð´Ð»Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ 603
                      // F -> t i , F | t i
                      // ------------------------------------------
                      Rule(NS('F'), GRB_ERROR_SERIES + 3, // 603 - ÐžÑˆÐ¸Ð±ÐºÐ° Ð² Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
                           2,
                           // F -> t i , F (Ñ€ÐµÐºÑƒÑ€ÑÐ¸Ð²Ð½Ñ‹Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹: 'integer x, ...')
                           Rule::Chain(4, TS('t'), TS('i'), TS(','), NS('F')),
                           // F -> t i (Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹: 'integer y')
                           Rule::Chain(2, TS('t'), TS('i'))
                      ),
                      // ------------------------------------------
                      // Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 3: Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ NS('W') Ð´Ð»Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ 604
                      // W -> E , W | E
                      // ------------------------------------------
                      Rule(NS('W'), GRB_ERROR_SERIES + 4, // 604 - ÐžÑˆÐ¸Ð±ÐºÐ° Ð² Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ñ… Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÐ¼Ð¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
                           2,
                           // W -> E , W (Ñ€ÐµÐºÑƒÑ€ÑÐ¸Ð²Ð½Ñ‹Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹: 'x, ...')
                           Rule::Chain(3, NS('E'), TS(','), NS('W')),
                           // W -> E (Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹: 'y')
                           Rule::Chain(1, NS('E'))
                      ),
                      // ------------------------------------------
                      // Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 4: Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ NS('M') Ð´Ð»Ñ Ð¿Ð¾Ð»Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ 602
                      // M -> v E | e (epsilon, Ð¿ÑƒÑÑ‚Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°, ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ð·Ð°Ð¼ÐµÐ½ÑÐµÑ‚)
                      // ÐŸÐ¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ð² Ð“ÐÐ¤ Ð½ÐµÐ»ÑŒÐ·Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ e, M Ð´Ð¾Ð»Ð¶ÐµÐ½ Ñ€Ð°Ð·Ð²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°Ñ‚ÑŒÑÑ Ð² ÑÐ¸Ð¼Ð²Ð¾Ð»,
                      // ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ Ð·Ð° Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸ÐµÐ¼ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ; Ð¸Ð»Ð¸ )
                      // ÐŸÑ€ÐµÐ´Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ð¼, M - ÑÑ‚Ð¾ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ i Ð¸Ð»Ð¸ l
                      // Ð˜ M - ÑÑ‚Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€ v E (v: +, -, *, /)
                      // Ð•ÑÐ»Ð¸ M ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¼ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸ÐµÐ¼:
                      // M -> v E | ; | ) | }
                      // ÐÐ¾ Ð² Ð²Ð°ÑˆÐ¸Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ñ… M Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ñ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ
                      // E -> i M
                      // E -> i v E | i
                      // => M -> v E
                      // M Ð½Ðµ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ Ð¿ÑƒÑÑ‚Ñ‹Ð¼! ÐŸÐ¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ E ÑƒÐ¶Ðµ Ð¸Ð¼ÐµÐµÑ‚ Ð½ÐµÑ€ÐµÐºÑƒÑ€ÑÐ¸Ð²Ð½Ñ‹Ðµ Ð²ÐµÑ‚ÐºÐ¸ i | l | (E) | i(W)
                      // M Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½ Ñ‚Ð°Ðº, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð½ Ð²ÑÐµÐ³Ð´Ð° Ð½Ð°Ñ‡Ð¸Ð½Ð°Ð»ÑÑ Ñ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ð°,
                      // Ð° ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ - ÑÑ‚Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€ v.
                      // M -> v E
                      // ------------------------------------------
                      Rule(NS('M'), GRB_ERROR_SERIES + 2, // ÐžÑˆÐ¸Ð±ÐºÐ° Ð² Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¸ (Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ðµ)
                           1, // M -> v E
                           Rule::Chain(2, TS('v'), NS('E'))
                      )
    );
}