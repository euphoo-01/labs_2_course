# **№ 9 Коллекции**

## Задание

- Создайте класс по варианту, определите в нем свойства и методы, реализуйте указанный интерфейс и другие при необходимости, соберите объекты класса в коллекцию (можно сделать специальных класс с вложенной коллекцией и методами ею управляющими), продемонстрируйте работу с ней (добавление/удаление/поиск/вывод:

| Вариант | Тип | Интерфейс | Коллекция |
| --- | --- | --- | --- |
| 1   | Автомобиль | IList&lt;T&gt; | Dictionary &lt; TKey, TValue&gt; |
| 2   | Книга | IDictionary&lt; TKey, TValue&gt; | List&lt;T&gt; |
| 3   | Товар | IOrderedDictionary | ConcurrentBag&lt;T&gt; |
| 4   | Работник | IEnumerable&lt;T&gt; | Hashtable |
| 5   | Студент | IEnumerable&lt;T&gt; | Queue&lt;T&gt; |
| 6   | Компьютер | ISet&lt;T&gt; | HashSet&lt;T&gt; |
| 7   | Программное обеспечение | IList&lt;T&gt; | SortedList &lt; TKey, TValue&gt; |
| 8   | Мебель | IList&lt;T&gt; | ArryList |
| 9   | Изображение | ISet&lt;T&gt; | LinkedList&lt;T&gt; |
| 10  | Игра | IEnumerable&lt;T&gt; | BlockingCollection&lt;T&gt; |
| 11  | Геометрическая фигура | IEnumerator | Stack |
| 12  | Интернет-ресурс | IList&lt;T&gt; | ConcurrentDictionery&lt; TKey, TValue&gt; |
| 13  | Услуги | IOrderedDictionary | Queue&lt;T&gt; |
| 14  | Концерт | любой | Dictionary &lt; TKey, TValue&gt; |
| 15  | Растение | IList&lt;T&gt; | HashSet&lt;T&gt; |

- Создайте **универсальную коллекцию** в соответствии с вариантом задания и заполнить ее данными встроенного типа .Net (int, char,…).
  - Выведите коллекцию на консоль
  - Удалите из коллекции n последовательных элементов
  - Добавьте другие элементы (используйте все возможные методы добавления для вашего типа коллекции).
  - Создайте _вторую коллекцию_ (из таблицы выберите другой тип коллекции) и заполните ее данными из первой коллекции.
  - Выведите вторую коллекцию на консоль. В случае не совпадения количества параметров (например, _LinkedList&lt;T&gt;_ и _Dictionary&lt;Tkey, TValue&gt;_), при нехватке - генерируйте ключи, в случае избыточности - оставляйте _TValue_.
  - Найдите во второй коллекции заданное значение.
- Создайте объект _наблюдаемой коллекции_  **ObservableCollection&lt;T&gt;**. Создайте произвольный метод и зарегистрируйте его на событие CollectionChange. Напишите демонстрацию с добавлением и удалением элементов. В качестве типа _T_ используйте свой класс из таблицы.

## Вопросы

Изучите

<https://learn.microsoft.com/en-us/dotnet/api/system.collections.generic?view=net-6.0>

<https://learn.microsoft.com/en-us/dotnet/api/system.collections.concurrent?view=net-6.0>

<https://learn.microsoft.com/en-us/dotnet/api/system.collections.specialized?view=net-6.0>

- На какие основные виды/типы делятся все коллекции .NET? Охарактеризуйте каждый из них.
- Что такое generic-коллекции? Назовите примеры известных вам generic-коллекций.
- В чем разница между ArrayList и Array?
- Охарактеризуйте коллекции, которые вы использовали в своем варианте.
- Чем отличаются коллекции, расположенные в пространстве имен System.Collections.Concurrent?
- Какое пространство имен необходимо подключить в проект, чтобы иметь возможность использовать generic-коллекции?
- Что такое наблюдаемая коллекция? Как ее можно использовать?
- Охарактеризуйте интерфейсы IEnumerator, IEnumerator. В чем отличие назначений интерфейсов IEnumerator и IEnumerable.
- Поясните принцип работы коллекций:

a. LinkedList &lt;T&gt;

b. HashSet &lt;T&gt;

c. Dictionary &lt;Tkey, TValue&gt;

d. ConcurrentBag &lt;Tkey, TValue&gt;

e. Stack&lt;t&gt;, Queue&lt;T&gt;

f. SortedList, SortedList.

**Теория**

В C# коллекция представляет собой совокупность объектов. В среде .NET Framework имеется немало интерфейсов и классов, в которых определяются и реализуются различные типы коллекций.

Главное преимущество коллекций заключается в том, что они стандартизируют обработку групп объектов в программе. Все коллекции разработаны на основе набора четко определенных интерфейсов. Некоторые встроенные реализации таких интерфейсов, в том числе ArrayList, Hashtable, Stack и Queue, могут применяться в исходном виде и без каких-либо изменений. Имеется также возможность реализовать собственную коллекцию, хотя потребность в этом возникает редко.

В среде .NET Framework поддерживаются пять типов коллекций: необобщенные, специальные, с поразрядной организацией, обобщенные и параллельные.

_Необобщенные коллекции_

Реализуют ряд основных структур данных, включая динамический массив, стек, очередь, а также словари, в которых можно хранить пары "ключ-значение". В отношении необобщенных коллекций важно иметь в виду следующее: они оперируют данными типа object. Таким образом, необобщенные коллекции могут служить для хранения данных любого типа, причем в одной коллекции допускается наличие разнотипных данных. Очевидно, что такие коллекции не типизированы, поскольку в них хранятся ссылки на данные типа object. Классы и интерфейсы необобщенных коллекций находятся в пространстве имен **System.Collections**.

_Специальные коллекции_

Оперируют данными конкретного типа или же делают это каким-то особым образом. Например, имеются специальные коллекции для символьных строк, а также специальные коллекции, в которых используется однонаправленный список. Специальные коллекции объявляются в пространстве имен **System.Collections.Specialized**.

_Поразрядная коллекция_

В прикладном интерфейсе Collections API определена одна коллекция с поразрядной организацией - это BitArray. Коллекция типа BitArray поддерживает поразрядные операции, т.е. операции над отдельными двоичными разрядами, например И, ИЛИ, исключающее ИЛИ, а следовательно, она существенно отличается своими возможностями от остальных типов коллекций. Коллекция типа BitArray объявляется в пространстве имен System.Collections.

_Обобщенные коллекции_

Обеспечивают обобщенную реализацию нескольких стандартных структур данных, включая связные списки, стеки, очереди и словари. Такие коллекции являются типизированными в силу их обобщенного характера. Это означает, что в обобщенной коллекции могут храниться только такие элементы данных, которые совместимы по типу с данной коллекцией. Благодаря этому исключается случайное несовпадение типов. Обобщенные коллекции объявляются в пространстве имен**System.Collections.Generic**.

_Параллельные коллекции_

Поддерживают многопоточный доступ к коллекции. Это обобщенные коллекции, определенные в пространстве имен **System.Collections.Concurrent**.

В пространстве имен System.Collections.ObjectModel находится также ряд классов, поддерживающих создание пользователями собственных обобщенных коллекций.

Основополагающим для всех коллекций является понятие _перечислителя_, который поддерживается в необобщенных интерфейсах IEnumerator и IEnumerable, а также в обобщенных интерфейсах IEnumerator&lt;T&gt; и IEnumerable&lt;T&gt;. Перечислитель обеспечивает стандартный способ поочередного доступа к элементам коллекции. Следовательно, он перечисляет содержимое коллекции. В каждой коллекции должна быть реализована обобщенная или необобщенная форма интерфейса IEnumerable, поэтому элементы любого класса коллекции должны быть доступны посредством методов, определенных в интерфейсе IEnumerator или IEnumerator&lt;T&gt;. Это означает, что, внеся минимальные изменения в код циклического обращения к коллекции одного типа, его можно использовать для аналогичного обращения к коллекции другого типа. Любопытно, что для поочередного обращения к содержимому коллекции в цикле foreach используется перечислитель.

С перечислителем непосредственно связано другое средство, называемое _итератором_. Это средство упрощает процесс создания классов коллекций, например специальных, поочередное обращение к которым организуется в цикле foreach.

Классы коллекций по своей сути подобны классам стандартной библиотеки шаблонов (Standard Template Library - STL), определенной в С++. То, что в программировании на С++ называется контейнером, в программировании на C# называется коллекцией.

### Интерфейсы обобщенных коллекций

В пространстве имен System.Collections.Generic определен целый ряд интерфейсов обобщенных коллекций, имеющих соответствующие аналоги среди интерфейсов необобщенных коллекций:

**ICollection&lt;T&gt;**

Определяет основополагающие свойства обобщенных коллекций

**IComparer&lt;T&gt;**

Определяет обобщенный метод Compare() для сравнения объектов, хранящихся в коллекции

**IDictionary&lt;Tkey, TValue&gt;**

Определяет обобщенную коллекцию, состоящую из пар "ключ-значение"

**IEnumerable&lt;T&gt;**

Определяет обобщенный метод GetEnumerator(), предоставляющий перечислитель для любого класса коллекции

**Enumerator&lt;T&gt;**

Предоставляет методы, позволяющие получать содержимое коллекции по очереди

**IEqualityComparer&lt;T&gt;**

Сравнивает два объекта на предмет равенства

**IList&lt;T&gt;**

Определяет обобщенную коллекцию, доступ к которой можно получить с помощью индексатора

В пространстве имен System.Collections.Generic определена структура **KeyValuePair&lt;TKey, TValue&gt;** Она служит для хранения ключа и его значения и применяется в классах обобщенных коллекций, в которых хранятся пары "ключ-значение", как, например, в классе Dictionary&lt;TKey, TValue&gt; В этой структуре определяются два следующих свойства:

public ТКеу Key { get; };

public TValue Value { get; };

В этих свойствах хранятся ключ и значение соответствующего элемента коллекции.

### Классы обобщенных коллекций

Kлассы обобщенных коллекций по большей части соответствуют своим необобщенным аналогам, хотя в некоторых случаях они носят другие имена. Отличаются они также своей организацией и функциональными возможностями. Классы обобщенных коллекций определяются в пространстве имен System.Collections.Generic:

**Dictionary&lt;Tkey, TValue&gt;**

Сохраняет пары "ключ-значение". Обеспечивает такие же функциональные возможности, как и необобщенный класс Hashtable

**HashSet&lt;T&gt;**

Сохраняет ряд уникальных значений, используя хештаблицу

**LinkedList&lt;T&gt;**

Сохраняет элементы в двунаправленном списке

**List&lt;T&gt;**

Создает динамический массив. Обеспечивает такие же функциональные возможности, как и необобщенный класс ArrayList

**Queue&lt;T&gt;**

Создает очередь. Обеспечивает такие же функциональные возможности, как и необобщенный класс Queue

**SortedDictionary&lt;TKey, TValue&gt;**

Создает отсортированный список из пар "ключ-значение"

**SortedList&lt;TKey, TValue&gt;**

Создает отсортированный список из пар "ключ-значение". Обеспечивает такие же функциональные возможности, как и необобщенный класс SortedList

**SortedSet&lt;T&gt;**

Создает отсортированное множество

**Stack&lt;T&gt;**

Создает стек. Обеспечивает такие же функциональные возможности, как и необобщенный класс Stack
